embedding will be saved at: /home/sxr280/BERTLocRNA/embeddings/Parnetembedding
loading the dataset...
Resolving data files: 100%|██████████| 243/243 [00:00<00:00, 508337.09it/s]
Resolving data files: 100%|██████████| 62/62 [00:00<00:00, 160324.81it/s]
Resolving data files: 100%|██████████| 77/77 [00:00<00:00, 244112.93it/s]
Downloading data files: 100%|██████████| 3/3 [00:00<00:00, 806.03it/s]
Extracting data files: 100%|██████████| 3/3 [00:02<00:00,  1.43it/s]


















































































































































































































Generating train split: 14650 examples [08:11, 29.83 examples/s]








































Generating validation split: 3670 examples [02:01, 30.18 examples/s]































































Generating test split: 4587 examples [02:38, 28.95 examples/s]
checkpoint_orig ['/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best.ckpt']
checkpoint_topup ['/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v3.ckpt', '/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v7.ckpt', '/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v2.ckpt', '/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v4.ckpt', '/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v1.ckpt', '/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v6.ckpt', '/home/sxr280/BERTLocRNA/output/RNAlocalization/parnet/checkpoints/checkpoints_best-v5.ckpt']
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/pytorch_lightning/loggers/wandb.py:395: UserWarning: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
  rank_zero_warn(
Calculating the best threshold for each target ...
calculating metrics: [[0 1 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 ...
 [0 0 1 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]] [[6.04191720e-01 9.82003093e-01 1.34676203e-01 ... 9.57436264e-02
  7.93167739e-04 2.38802703e-03]
 [3.30870360e-01 9.40831602e-01 3.19676697e-02 ... 3.26835774e-02
  1.03174567e-01 1.17865428e-02]
 [5.98851025e-01 9.83927190e-01 1.24680415e-01 ... 9.13006589e-02
  7.47386657e-04 2.14494579e-03]
 ...
 [2.46298745e-01 9.18067038e-01 1.74920186e-02 ... 1.49910776e-02
  3.75432223e-01 1.18179191e-02]
 [5.59182286e-01 9.74227905e-01 1.09375745e-01 ... 9.46966335e-02
  2.27509765e-03 3.70556070e-03]
 [2.41116583e-01 9.22850549e-01 1.59754474e-02 ... 1.35121569e-02
  3.78986746e-01 1.11623881e-02]]
Calculating the best threshold for each target ...
calculating metrics: [[1 1 0 ... 0 0 0]
 [1 1 0 ... 0 0 0]
 [1 1 0 ... 0 0 0]
 ...
 [0 1 0 ... 0 1 1]
 [0 1 0 ... 0 1 1]
 [0 1 0 ... 0 1 1]] [[0.17685604 0.8817869  0.00866798 ... 0.00619153 0.82418156 0.01095075]
 [0.17543316 0.8812659  0.00850104 ... 0.0060347  0.8302656  0.01075376]
 [0.17586759 0.88246506 0.00852873 ... 0.00605538 0.82750285 0.01070518]
 ...
 [0.16581921 0.8781357  0.00767036 ... 0.00524283 0.8586575  0.01001634]
 [0.16613188 0.87831974 0.00768475 ... 0.00525216 0.8582337  0.01002188]
 [0.1659968  0.8782867  0.0076793  ... 0.00524908 0.858523   0.01001577]]
Calculating the best threshold for each target ...
calculating metrics: [[1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]] [[0.20779732 0.89542735 0.01041875 0.09233163 0.04015755 0.01571065
  0.00838446 0.73645806 0.01128209]
 [0.20615208 0.8953057  0.01029915 0.09119675 0.03958936 0.01549001
  0.00824799 0.74283797 0.01127045]
 [0.20050251 0.8933282  0.00965523 0.08750785 0.03699786 0.01481092
  0.0075533  0.7699025  0.0108869 ]
 [0.19783694 0.8865814  0.00978891 0.08684408 0.03714729 0.01478275
  0.00756183 0.7881248  0.01133742]]
Calculating the best threshold for each target ...
calculating metrics: [[1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [1 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [0 1 0 0 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]
 [1 1 0 1 0 0 0 1 0]] [[0.17842014 0.882643   0.00870237 0.07402842 0.03037854 0.01319916
  0.00618285 0.8259419  0.01079309]
 [0.1892703  0.88753235 0.00975318 0.08122306 0.03452239 0.01449463
  0.00725834 0.7858198  0.01146734]
 [0.18018343 0.8836074  0.00883249 0.07501326 0.03085158 0.01337097
  0.00631094 0.82103384 0.01087203]
 [0.17760912 0.8820661  0.00868764 0.07354985 0.03024202 0.01319181
  0.0061674  0.8274203  0.0108084 ]
 [0.17723434 0.88147    0.00867953 0.07341088 0.03035717 0.01315955
  0.00617458 0.82828116 0.01082928]
 [0.17624515 0.8817688  0.00857894 0.07268616 0.0298903  0.01304915
  0.00606875 0.8315696  0.01069278]
 [0.17794901 0.8820267  0.0086747  0.07374023 0.03022611 0.01322897
  0.00615051 0.82848895 0.01078058]
 [0.17887738 0.8821094  0.00881667 0.07451509 0.03089355 0.0133065
  0.00630045 0.8225147  0.01095967]
 [0.18195772 0.8829816  0.00894611 0.07631637 0.03142231 0.01360533
  0.00642215 0.8194058  0.0109278 ]
 [0.18834908 0.88713217 0.0095929  0.07972176 0.03395802 0.01433618
  0.00712078 0.7871613  0.01136672]
 [0.17477396 0.8822994  0.00837827 0.07128008 0.02927724 0.01269778
  0.00590466 0.834987   0.01055127]
 [0.18161066 0.8838608  0.00903849 0.07610431 0.03158129 0.01370175
  0.00650674 0.8138766  0.0110013 ]
 [0.19638748 0.88858163 0.01043811 0.08616655 0.03698212 0.01556007
  0.00787281 0.7632556  0.01167091]
 [0.17560108 0.8813876  0.00851553 0.07235953 0.02975917 0.01295423
  0.0060228  0.8320093  0.01071406]
 [0.18166521 0.8855195  0.00897016 0.07569382 0.03169413 0.01342216
  0.00650773 0.8090489  0.01102262]
 [0.20389268 0.8898688  0.0113086  0.09187682 0.04062374 0.0163814
  0.00873876 0.72249156 0.01238006]
 [0.17633772 0.8819763  0.0085609  0.07280537 0.0298185  0.01303139
  0.00605165 0.8310844  0.01071458]
 [0.1813427  0.88148695 0.00912842 0.07638137 0.03184406 0.01364901
  0.00654996 0.8164558  0.01129072]
 [0.17622459 0.88086176 0.00858424 0.07269675 0.02995767 0.01296505
  0.0060734  0.8318982  0.01077602]
 [0.19674046 0.8907134  0.01017179 0.08568449 0.03641275 0.01507164
  0.00769425 0.76006657 0.01155211]
 [0.17599416 0.88183844 0.00850881 0.07251839 0.02971382 0.01294236
  0.00601295 0.83232826 0.01067052]
 [0.18086387 0.88351583 0.00885312 0.07531707 0.03115306 0.01345892
  0.00635165 0.821178   0.01083679]
 [0.19960406 0.8943156  0.01068783 0.08722692 0.03845568 0.01556636
  0.00831261 0.7301631  0.01175824]
 [0.18784176 0.8882581  0.00953949 0.07939359 0.03368668 0.01410938
  0.00705349 0.7889423  0.01131645]
 [0.18337874 0.88486356 0.00929116 0.07727477 0.03270655 0.01383151
  0.00679803 0.8026058  0.01128997]
 [0.17504579 0.88283175 0.00842019 0.07157165 0.0294574  0.01272962
  0.00594563 0.8331666  0.01056351]
 [0.18595366 0.8867799  0.00950162 0.07858204 0.0333393  0.01411792
  0.00698959 0.7915192  0.01133599]
 [0.18296182 0.8861669  0.00919813 0.07652877 0.03226602 0.01363819
  0.00670921 0.80264443 0.01121832]
 [0.1854765  0.88625497 0.00946041 0.07860629 0.03342285 0.01401199
  0.00699691 0.79057026 0.01150492]
 [0.1870701  0.88683915 0.00949508 0.07897445 0.03362329 0.01417642
  0.007037   0.7884798  0.01142569]
 [0.17592897 0.8823235  0.0084941  0.07225741 0.0297055  0.01287549
  0.00601271 0.82984424 0.01068914]
 [0.17686269 0.8827205  0.00855557 0.07265212 0.02987858 0.01300617
  0.00605934 0.83005244 0.01063839]
 [0.17503975 0.88223577 0.00834755 0.07159801 0.02917469 0.01275705
  0.00586793 0.8366905  0.01048802]
 [0.17506737 0.8815988  0.00845367 0.07190579 0.02953699 0.01285434
  0.00597188 0.83303285 0.0106381 ]
 [0.17530143 0.8819263  0.00846202 0.07183955 0.02947822 0.01286824
  0.00596747 0.8330635  0.01063631]
 [0.18951467 0.8885647  0.00976915 0.08075111 0.03482503 0.01439065
  0.00732684 0.77487063 0.01157205]
 [0.17493795 0.88218117 0.00842038 0.07171557 0.02938287 0.0127989
  0.00593492 0.833295   0.01057967]
 [0.1859961  0.88642675 0.0095112  0.07859616 0.03363504 0.01400558
  0.00703555 0.7903134  0.01147495]
 [0.18365498 0.8842085  0.00912833 0.07737634 0.03206749 0.0137447
  0.00660965 0.8125025  0.01110255]
 [0.18780452 0.8888192  0.00963666 0.07961337 0.03404096 0.01415703
  0.00713229 0.78520596 0.01142182]
 [0.17601764 0.88249457 0.00849378 0.07229684 0.02967959 0.01292216
  0.00601892 0.82933897 0.01067938]
 [0.18245052 0.8841288  0.00901683 0.07634693 0.0317084  0.01363273
  0.00650828 0.8157422  0.01096688]
 [0.18204114 0.8836735  0.00924393 0.07687055 0.03240386 0.01373523
  0.00670212 0.80881715 0.01129285]
 [0.17965727 0.8829167  0.00888208 0.07513618 0.03098613 0.01344479
  0.00634052 0.820596   0.01092668]
 [0.17506835 0.88183224 0.0084458  0.07179485 0.02954788 0.0128347
  0.00597612 0.8320443  0.01069318]
 [0.18398601 0.8862398  0.00923849 0.07732624 0.0327254  0.0136531
  0.00678723 0.79654497 0.01132446]
 [0.1780563  0.88248956 0.00868561 0.07375487 0.03044925 0.01320686
  0.00620215 0.82375485 0.01084721]
 [0.1873516  0.8884519  0.00952284 0.07942796 0.03362822 0.01400124
  0.00702779 0.7864204  0.01141903]
 [0.18053214 0.8834509  0.00893518 0.07528578 0.03123586 0.01353224
  0.00642851 0.8160668  0.01098865]
 [0.1884421  0.8842387  0.00990164 0.08139456 0.03498644 0.0146144
  0.00735598 0.785555   0.01185208]
 [0.17974222 0.87996376 0.00900694 0.07556576 0.03137495 0.01351472
  0.00641695 0.8257342  0.01117168]
 [0.17781323 0.8818618  0.00866791 0.0736722  0.03037106 0.0132103
  0.00618265 0.8277505  0.01080098]
 [0.17745835 0.88195914 0.00862125 0.07329184 0.03021942 0.0131313
  0.00613413 0.8294914  0.01073067]
 [0.18501553 0.88352054 0.00945313 0.07846414 0.03309248 0.01408154
  0.00687203 0.8048813  0.0113396 ]
 [0.17895257 0.8823193  0.00875775 0.07445478 0.03054203 0.01331318
  0.00623026 0.8253047  0.01085794]
 [0.194884   0.8881605  0.01024429 0.08466183 0.03693035 0.01507724
  0.00778608 0.75871444 0.01188272]
 [0.19727573 0.8936364  0.01058722 0.08577004 0.03774576 0.01538931
  0.00815805 0.73614496 0.01177758]
 [0.18151242 0.8842113  0.00910952 0.07612426 0.03198569 0.01354811
  0.00660479 0.8097547  0.01119895]
 [0.20175363 0.89474094 0.01091562 0.08893022 0.0390746  0.01586106
  0.00847778 0.71920216 0.01190467]
 [0.18530555 0.88690937 0.00941752 0.07813647 0.03322849 0.01406941
  0.00694824 0.79185283 0.01126948]
 [0.18550807 0.8867452  0.0094378  0.07839028 0.03317658 0.01390594
  0.00690744 0.7972436  0.01133053]
 [0.17391974 0.8794476  0.00840287 0.07150327 0.02931187 0.01277895
  0.00589607 0.8399523  0.01068781]
 [0.1857776  0.88454807 0.00954488 0.079498   0.03360891 0.01410598
  0.00699533 0.7958356  0.0115624 ]
 [0.18117602 0.88184667 0.0091064  0.07602549 0.03168124 0.01367133
  0.00651387 0.81982565 0.01110934]
 [0.18226993 0.8841359  0.00921979 0.07686088 0.03215176 0.01374679
  0.00666985 0.8083975  0.01126658]
 [0.17590426 0.8818648  0.00851305 0.07230192 0.02990911 0.01290023
  0.00605396 0.8312654  0.01069125]
 [0.17949834 0.8830359  0.00886873 0.0746913  0.03105773 0.01334883
  0.00636317 0.8191775  0.01098109]
 [0.18589856 0.8874628  0.00945793 0.07830784 0.03331694 0.0138694
  0.00698535 0.79129225 0.01142439]
 [0.17718919 0.8822156  0.00860814 0.0731323  0.03005335 0.01309398
  0.00609994 0.8293773  0.01071287]
 [0.19525751 0.8910766  0.01038993 0.0841729  0.03713759 0.01509023
  0.00797478 0.7492246  0.01186654]
 [0.20029446 0.8899883  0.01063813 0.08869176 0.03840563 0.01584201
  0.00817959 0.74935806 0.01177641]
 [0.17571831 0.8810095  0.00855727 0.07240947 0.02988472 0.01292415
  0.00605247 0.83301145 0.01076963]
 [0.17541392 0.8813642  0.00849653 0.07202684 0.02973577 0.01285586
  0.00603098 0.83174986 0.01074691]
 [0.1771319  0.88203216 0.00867174 0.07334162 0.03028802 0.01309372
  0.00614952 0.82897896 0.01081661]
 [0.18467456 0.88569736 0.00936027 0.07788814 0.03300408 0.01393336
  0.00687506 0.79652005 0.01138117]
 [0.17653939 0.88201123 0.00857069 0.0728199  0.02992322 0.01299815
  0.00606997 0.82930005 0.01076694]
 [0.18949339 0.88952607 0.0099187  0.08075631 0.03464229 0.01427058
  0.00740661 0.7687508  0.01181286]
 [0.17939527 0.8816078  0.00887496 0.07481524 0.03123532 0.01342747
  0.00638592 0.82102567 0.01101452]
 [0.18805711 0.88811755 0.00956666 0.07942075 0.03389987 0.01417388
  0.00711178 0.78279996 0.011585  ]
 [0.18791904 0.8860689  0.00956456 0.08038066 0.03374685 0.01419633
  0.00704448 0.78755325 0.01158105]
 [0.2034363  0.8925649  0.0113723  0.09090821 0.04039738 0.01637876
  0.00880633 0.7166522  0.01219407]
 [0.18399198 0.88639253 0.0093252  0.07735191 0.03266609 0.01377139
  0.00682714 0.7967969  0.01133458]
 [0.1749508  0.8820262  0.0084186  0.0715086  0.02952391 0.01278389
  0.0059719  0.8319389  0.0106458 ]
 [0.19112661 0.8899193  0.00972124 0.08102883 0.03443608 0.01435502
  0.00724944 0.77405435 0.01148726]
 [0.1982442  0.89155185 0.01066753 0.08627365 0.03781218 0.01553106
  0.00820425 0.7408477  0.01197456]
 [0.18150175 0.8848268  0.0090348  0.07564969 0.03187011 0.01349992
  0.00655654 0.8107615  0.01104601]
 [0.19066715 0.8889065  0.00992973 0.08208118 0.03493116 0.01464822
  0.00738047 0.77415437 0.01157873]
 [0.20259684 0.89352685 0.01071482 0.08983152 0.04073043 0.01560337
  0.00865893 0.7217025  0.01194774]
 [0.17840956 0.879989   0.00892262 0.07470838 0.03102034 0.01338693
  0.00633251 0.8280269  0.01106893]
 [0.18389086 0.8848971  0.00922268 0.0772753  0.03237332 0.01390227
  0.00668713 0.8069507  0.01106557]
 [0.20377474 0.89627814 0.01103149 0.09049368 0.03930486 0.01611571
  0.00856081 0.71169525 0.01182804]
 [0.17758371 0.88188535 0.00869791 0.07340109 0.03054409 0.01317162
  0.00621475 0.82533187 0.01088783]
 [0.17604874 0.8820068  0.008565   0.07259642 0.03001544 0.0130001
  0.00609229 0.8288339  0.01081305]
 [0.17766435 0.8825996  0.00872293 0.07355049 0.03048596 0.01316613
  0.00622555 0.8240463  0.01087082]
 [0.18752924 0.8837139  0.00977537 0.08062142 0.03417069 0.01442235
  0.00714364 0.7970952  0.01161917]
 [0.17624006 0.8821231  0.00851253 0.07245187 0.02976329 0.01292935
  0.00602516 0.83016145 0.01068592]]
Calculating the best threshold for each target ...
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:864: RuntimeWarning: invalid value encountered in true_divide
  recall = tps / tps[-1]
/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
calculating metrics: [[0 1 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 ...
 [0 1 0 ... 1 0 0]
 [0 1 0 ... 1 0 0]
 [0 1 0 ... 1 0 0]] [[6.05108917e-01 9.79104638e-01 9.78588313e-02 ... 1.00517891e-01
  1.92679244e-03 3.05528683e-03]
 [8.04780960e-01 9.95324314e-01 2.39798307e-01 ... 1.22151233e-01
  1.39114418e-05 3.43507039e-04]
 [6.66897118e-01 9.80081439e-01 1.68625712e-01 ... 1.20144762e-01
  1.49986194e-03 3.46567552e-03]
 ...
 [8.06479037e-01 9.94976044e-01 3.27430218e-01 ... 1.31178513e-01
  1.42903282e-05 3.71178030e-04]
 [7.20124245e-01 9.91062999e-01 1.30317077e-01 ... 1.20562494e-01
  2.50128098e-04 9.26028297e-04]
 [6.34495020e-01 9.84067440e-01 9.90004539e-02 ... 1.01778686e-01
  1.17296772e-03 2.11207545e-03]]
[2023-12-04 20:50:10,699][HYDRA] 	#1 : model=base_model task=RNAlocalization embedder=nucleotidetransformer
output dir of this job: /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer
/home/sxr280/BERTLocRNA/saved_model/NT  already exists, loading the model locally

Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.81s/it]
Some weights of the model checkpoint at /home/sxr280/BERTLocRNA/saved_model/NT were not used when initializing EsmModel: ['lm_head.decoder.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.bias', 'lm_head.layer_norm.weight', 'lm_head.bias', 'lm_head.dense.weight']
- This IS expected if you are initializing EsmModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing EsmModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of EsmModel were not initialized from the model checkpoint at /home/sxr280/BERTLocRNA/saved_model/NT and are newly initialized: ['esm.pooler.dense.weight', 'esm.pooler.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map:   0%|          | 0/14650 [00:02<?, ? examples/s]
Error executing job with overrides: ['model=base_model', 'task=RNAlocalization', 'embedder=nucleotidetransformer']
Traceback (most recent call last):
  File "/home/sxr280/BERTLocRNA/scripts/train_model.py", line 54, in <module>
    train()
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/main.py", line 90, in decorated_main
    _run_hydra(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/utils.py", line 465, in _run_app
    run_and_report(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/utils.py", line 222, in run_and_report
    raise ex
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/utils.py", line 219, in run_and_report
    return func()
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/utils.py", line 466, in <lambda>
    lambda: hydra.multirun(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/hydra.py", line 162, in multirun
    ret = sweeper.sweep(arguments=task_overrides)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/_internal/core_plugins/basic_sweeper.py", line 182, in sweep
    _ = r.return_value
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/sxr280/BERTLocRNA/scripts/train_model.py", line 42, in train
    train_dataloader, test_dataloader, eval_dataloader = embedder(dataset)
  File "/home/sxr280/BERTLocRNA/scripts/../../BERTLocRNA/utils/embedding_generator.py", line 119, in __call__
    return self.process(dataset)
  File "/home/sxr280/BERTLocRNA/scripts/../../BERTLocRNA/utils/embedding_generator.py", line 293, in process
    tokenized_datasets = dataset.map(self.segment_embedder, batched = True, batch_size = self.batch_size)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/dataset_dict.py", line 855, in map
    {
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/dataset_dict.py", line 856, in <dictcomp>
    k: dataset.map(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 591, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 556, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3089, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3466, in _map_single
    batch = apply_function_on_filtered_inputs(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3345, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "/home/sxr280/BERTLocRNA/scripts/../../BERTLocRNA/utils/embedding_generator.py", line 272, in segment_embedder
    left_embeds, truncated_embeds, left_masks, truncated_masks = self.merge_input(left, truncated)
  File "/home/sxr280/BERTLocRNA/scripts/../../BERTLocRNA/utils/embedding_generator.py", line 105, in merge_input
    left_embeds = self.get_embed(left_ids, left_masks)
  File "/home/sxr280/BERTLocRNA/scripts/../../BERTLocRNA/utils/embedding_generator.py", line 235, in get_embed
    outs = self.model(tokens_ids,
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/transformers/models/esm/modeling_esm.py", line 922, in forward
    encoder_outputs = self.encoder(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/transformers/models/esm/modeling_esm.py", line 622, in forward
    layer_outputs = layer_module(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/transformers/models/esm/modeling_esm.py", line 507, in forward
    self_attention_outputs = self.attention(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/transformers/models/esm/modeling_esm.py", line 441, in forward
    self_outputs = self.self(
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sxr280/miniconda3/envs/deeploc_torch/lib/python3.8/site-packages/transformers/models/esm/modeling_esm.py", line 365, in forward
    attention_scores = attention_scores + attention_mask
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.77 GiB (GPU 0; 23.64 GiB total capacity; 19.32 GiB already allocated; 3.98 GiB free; 19.38 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF