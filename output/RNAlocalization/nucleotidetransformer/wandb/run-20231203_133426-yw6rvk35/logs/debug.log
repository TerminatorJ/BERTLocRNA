2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_setup.py:_flush():76] Configure stats pid to 2691005
2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/.config/wandb/settings
2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/BERTLocRNA/scripts/wandb/settings
2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'root_dir': '/home/sxr280/wandb_logs'}
2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/train_model.py', 'program': 'train_model.py'}
2023-12-03 13:34:26,328 INFO    MainThread:2691005 [wandb_init.py:_log_setup():506] Logging user logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer/wandb/run-20231203_133426-yw6rvk35/logs/debug.log
2023-12-03 13:34:26,329 INFO    MainThread:2691005 [wandb_init.py:_log_setup():507] Logging internal logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer/wandb/run-20231203_133426-yw6rvk35/logs/debug-internal.log
2023-12-03 13:34:26,329 INFO    MainThread:2691005 [wandb_init.py:init():546] calling init triggers
2023-12-03 13:34:26,329 INFO    MainThread:2691005 [wandb_init.py:init():552] wandb.init called with sweep_config: {}
config: {'_metadata': ContainerMetadata(ref_type=typing.Any, object_type=<class 'dict'>, optional=True, key=None, flags={'struct': True}, flags_root=False, resolver_cache=defaultdict(<class 'dict'>, {'now': {('%Y-%m-%d',): '2023-12-03', ('%H-%M-%S',): '13-33-44'}}), key_type=typing.Any, element_type=typing.Any), '_parent': None, '_flags_cache': {'struct': True, 'convert': None}, '_content': {'model': 'base_model', 'task': 'RNAlocalization', 'embedder': 'nucleotidetransformer', 'batch_size': 8, 'compartments': ['Nucleus', 'Exosome', 'Cytosol', 'Cytoplasm', 'Ribosome', 'Membrane', 'Endoplasmic reticulum', 'Microvesicle', 'Mitochondrion'], 'output_dir': '${hydra:runtime.cwd}/../output/${task}/${embedder}', 'RNAlocalization': {'path': 'TerminatorJ/localization_multiRNA'}, 'wandb': {'project': 'BERTLocRNA', 'name': 'benchmark_embedding'}, 'base_model': {'_target_': 'BERTLocRNA.models.base_model.CustomizedModel', 'config': {'nb_classes': 9, 'dim_attention': 80, 'headnum': 3, 'drop_flat': 0.25, 'Att_regularizer_weight': 0.001, 'fc_dim': 100, 'normalizeatt': True, 'attmod': 'smooth', 'sharp_beta': 1, 'activation': 'gelu', 'activation_att': 'tanh', 'attention': True, 'RNA_dim': 4, 'hidden_dim': '${${embedder}.hidden_dim}', 'RNA_order': ['UNK', 'A', 'C', 'G', 'T', 'N', 'Y RNA', 'lincRNA', 'lncRNA', 'mRNA', 'miRNA', 'ncRNA', 'pseudo', 'rRNA', 'scRNA', 'scaRNA', 'snRNA', 'snoRNA', 'vRNA']}}, 'parnet': {'_target_': 'BERTLocRNA.utils.embedding_generator.ParnetEmbedder', 'model_path': '/home/sxr280/BERTLocRNA/RBPLLM/Parnet', 'batch_size': '${batch_size}', 'dataloader': True, 'hidden_dim': 256, 'collator': 'talse'}, 'nucleotidetransformer': {'_target_': 'BERTLocRNA.utils.embedding_generator.NucleotideTransformerEmbedder', 'model_path': 'InstaDeepAI/nucleotide-transformer-2.5b-multi-species', 'batch_size': '${batch_size}', 'dataloader': True, 'hidden_dim': 2560, 'collator': True}, 'Trainer': {'config': {'class_weights': 'None', 'accelerator': 'gpu', 'strategy': 'ddp', 'max_epochs': 500, 'precison': 32, 'num_nodes': 1, 'log_every_n_steps': 1000, 'patience': 20, 'optimizer_cls': 'torch.optim.Adam', 'lr': 0.001, 'weight_decay': 1e-05, 'output_dir': '${output_dir}', 'RNA_order': '${base_model.config.RNA_order}'}}}}
2023-12-03 13:34:26,329 INFO    MainThread:2691005 [wandb_init.py:init():597] wandb.init() called when a run is still active
2023-12-03 13:35:07,666 WARNING MsgRouterThr:2691005 [router.py:message_loop():77] message_loop has been closed
