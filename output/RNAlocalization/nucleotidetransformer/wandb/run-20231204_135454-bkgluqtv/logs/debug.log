2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_setup.py:_flush():76] Configure stats pid to 980015
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/.config/wandb/settings
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/BERTLocRNA/scripts/wandb/settings
2023-12-04 13:54:54,059 WARNING MainThread:980015 [wandb_setup.py:_flush():76] Unknown environment variable: WANDB_SERVICE
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'root_dir': '/home/sxr280/wandb_logs'}
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/train_model.py', 'program': '/home/sxr280/BERTLocRNA/scripts/train_model.py'}
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_init.py:_log_setup():506] Logging user logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer/wandb/run-20231204_135454-bkgluqtv/logs/debug.log
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_init.py:_log_setup():507] Logging internal logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer/wandb/run-20231204_135454-bkgluqtv/logs/debug-internal.log
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_init.py:init():546] calling init triggers
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_init.py:init():552] wandb.init called with sweep_config: {}
config: {'_metadata': ContainerMetadata(ref_type=typing.Any, object_type=<class 'dict'>, optional=True, key=None, flags={'struct': True}, flags_root=False, resolver_cache=defaultdict(<class 'dict'>, {'now': {('%Y-%m-%d',): '2023-12-04', ('%H-%M-%S',): '13-54-53'}}), key_type=typing.Any, element_type=typing.Any), '_parent': None, '_flags_cache': {'struct': True, 'convert': None}, '_content': {'model': 'base_model', 'task': 'RNAlocalization', 'embedder': 'nucleotidetransformer', 'batch_size': 64, 'compartments': ['Nucleus', 'Exosome', 'Cytosol', 'Cytoplasm', 'Ribosome', 'Membrane', 'Endoplasmic reticulum', 'Microvesicle', 'Mitochondrion'], 'output_dir': '${hydra:runtime.cwd}/../output/${task}/${embedder}', 'nb_classes': 9, 'RNAlocalization': {'path': 'TerminatorJ/localization_multiRNA'}, 'wandb': {'project': 'BERTLocRNA', 'name': 'benchmark_embedding'}, 'base_model': {'_target_': 'BERTLocRNA.models.base_model.CustomizedModel', 'config': {'nb_classes': 9, 'dim_attention': 80, 'headnum': 3, 'drop_flat': 0.25, 'Att_regularizer_weight': 0.001, 'fc_dim': 100, 'normalizeatt': True, 'attmod': 'smooth', 'sharp_beta': 1, 'activation': 'gelu', 'activation_att': 'tanh', 'attention': True, 'RNA_dim': 4, 'pooling_size': 8, 'hidden_dim': '${${embedder}.hidden_dim}', 'RNA_order': ['UNK', 'A', 'C', 'G', 'T', 'N', 'Y RNA', 'lincRNA', 'lncRNA', 'mRNA', 'miRNA', 'ncRNA', 'pseudo', 'rRNA', 'scRNA', 'scaRNA', 'snRNA', 'snoRNA', 'vRNA']}}, 'parnet': {'_target_': 'BERTLocRNA.utils.embedding_generator.ParnetEmbedder', 'model_path': '/home/sxr280/BERTLocRNA/RBPLLM/Parnet', 'batch_size': '${batch_size}', 'dataloader': True, 'hidden_dim': 256, 'collator': False, 'pool_size': 8}, 'nucleotidetransformer': {'_target_': 'BERTLocRNA.utils.embedding_generator.NucleotideTransformerEmbedder', 'model_path': 'InstaDeepAI/nucleotide-transformer-2.5b-multi-species', 'batch_size': '${batch_size}', 'dataloader': True, 'hidden_dim': 2560, 'collator': True, 'pool_size': 8}, 'Trainer': {'config': {'accelerator': 'gpu', 'strategy': 'ddp', 'max_epochs': 1, 'precison': 32, 'num_nodes': 1, 'log_every_n_steps': 1000, 'patience': 20, 'gradient_clip': True, 'optimizer_cls': 'torch.optim.Adam', 'lr': 0.001, 'weight_decay': 1e-05, 'nb_classes': '${nb_classes}', 'output_dir': '${output_dir}', 'RNA_order': '${base_model.config.RNA_order}', 'compartments': '${compartments}'}}}}
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_init.py:init():602] starting backend
2023-12-04 13:54:54,059 INFO    MainThread:980015 [wandb_init.py:init():606] setting up manager
2023-12-04 13:54:54,061 INFO    MainThread:980015 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-12-04 13:54:54,063 INFO    MainThread:980015 [wandb_init.py:init():613] backend started and connected
2023-12-04 13:54:54,067 INFO    MainThread:980015 [wandb_init.py:init():701] updated telemetry
2023-12-04 13:54:54,090 INFO    MainThread:980015 [wandb_init.py:init():741] communicating run to backend with 60.0 second timeout
2023-12-04 13:54:54,763 INFO    MainThread:980015 [wandb_run.py:_on_init():2133] communicating current version
2023-12-04 13:54:54,839 INFO    MainThread:980015 [wandb_run.py:_on_init():2142] got version response upgrade_message: "wandb version 0.16.0 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-12-04 13:54:54,839 INFO    MainThread:980015 [wandb_init.py:init():789] starting run threads in backend
2023-12-04 13:55:02,856 INFO    MainThread:980015 [wandb_run.py:_console_start():2114] atexit reg
2023-12-04 13:55:02,856 INFO    MainThread:980015 [wandb_run.py:_redirect():1969] redirect: SettingsConsole.WRAP_RAW
2023-12-04 13:55:02,857 INFO    MainThread:980015 [wandb_run.py:_redirect():2034] Wrapping output streams.
2023-12-04 13:55:02,857 INFO    MainThread:980015 [wandb_run.py:_redirect():2059] Redirects installed.
2023-12-04 13:55:02,857 INFO    MainThread:980015 [wandb_init.py:init():831] run started, returning control to user process
