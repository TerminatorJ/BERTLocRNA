2023-12-01 15:54:14,555 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Configure stats pid to 81570
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/.config/wandb/settings
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/BERTLocRNA/scripts/wandb/settings
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'root_dir': '/home/sxr280/wandb_logs'}
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/train_model.py', 'program': 'train_model.py'}
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_init.py:_log_setup():506] Logging user logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer/wandb/run-20231201_155414-1f8ntfr0/logs/debug.log
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_init.py:_log_setup():507] Logging internal logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/nucleotidetransformer/wandb/run-20231201_155414-1f8ntfr0/logs/debug-internal.log
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_init.py:init():546] calling init triggers
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_init.py:init():552] wandb.init called with sweep_config: {}
config: {'_metadata': ContainerMetadata(ref_type=typing.Any, object_type=<class 'dict'>, optional=True, key=None, flags={'struct': True}, flags_root=False, resolver_cache=defaultdict(<class 'dict'>, {'now': {('%Y-%m-%d',): '2023-12-01', ('%H-%M-%S',): '15-54-12'}}), key_type=typing.Any, element_type=typing.Any), '_parent': None, '_flags_cache': {'struct': True, 'convert': None}, '_content': {'model': 'base_model', 'task': 'RNAlocalization', 'embedder': 'nucleotidetransformer', 'batch_size': 8, 'compartments': ['Nucleus', 'Exosome', 'Cytosol', 'Cytoplasm', 'Ribosome', 'Membrane', 'Endoplasmic reticulum', 'Microvesicle', 'Mitochondrion'], 'output_dir': '${hydra:runtime.cwd}/../output/${task}/${embedder}', 'RNAlocalization': {'path': 'TerminatorJ/localization_multiRNA'}, 'wandb': {'project': 'BERTLocRNA', 'name': 'benchmark_embedding'}, 'base_model': {'_target_': 'BERTLocRNA.models.base_model.CustomizedModel', 'config': {'nb_classes': 9, 'dim_attention': 80, 'headnum': 3, 'drop_flat': 0.25, 'Att_regularizer_weight': 0.001, 'fc_dim': 100, 'normalizeatt': True, 'attmod': 'smooth', 'sharp_beta': 1, 'activation': 'gelu', 'activation_att': 'tanh', 'attention': True, 'RNA_dim': 4, 'RNA_order': ['UNK', 'A', 'C', 'G', 'T', 'N', 'Y RNA', 'lincRNA', 'lncRNA', 'mRNA', 'miRNA', 'ncRNA', 'pseudo', 'rRNA', 'scRNA', 'scaRNA', 'snRNA', 'snoRNA', 'vRNA']}}, 'parnet': {'_target_': 'BERTLocRNA.utils.embedding_generator.ParnetEmbedder', 'model_path': '/home/sxr280/BERTLocRNA/RBPLLM/Parnet', 'batch_size': '${batch_size}', 'dataloader': True}, 'nucleotidetransformer': {'_target_': 'BERTLocRNA.utils.embedding_generator.NucleotideTransformerEmbedder', 'model_path': 'InstaDeepAI/nucleotide-transformer-2.5b-multi-species', 'batch_size': '${batch_size}', 'dataloader': True}, 'Trainer': {'config': {'class_weights': 'None', 'accelerator': 'gpu', 'strategy': 'ddp', 'max_epochs': 500, 'precison': 32, 'num_nodes': 1, 'log_every_n_steps': 1000, 'patience': 20, 'output_dir': '${output_dir}', 'RNA_order': '${base_model.config.RNA_order}'}}}}
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_init.py:init():602] starting backend
2023-12-01 15:54:14,556 INFO    MainThread:81570 [wandb_init.py:init():606] setting up manager
2023-12-01 15:54:14,558 INFO    MainThread:81570 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-12-01 15:54:14,560 INFO    MainThread:81570 [wandb_init.py:init():613] backend started and connected
2023-12-01 15:54:14,563 INFO    MainThread:81570 [wandb_init.py:init():701] updated telemetry
2023-12-01 15:54:14,587 INFO    MainThread:81570 [wandb_init.py:init():741] communicating run to backend with 60.0 second timeout
2023-12-01 15:54:15,122 INFO    MainThread:81570 [wandb_run.py:_on_init():2133] communicating current version
2023-12-01 15:54:15,190 INFO    MainThread:81570 [wandb_run.py:_on_init():2142] got version response upgrade_message: "wandb version 0.16.0 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-12-01 15:54:15,190 INFO    MainThread:81570 [wandb_init.py:init():789] starting run threads in backend
2023-12-01 15:54:21,745 INFO    MainThread:81570 [wandb_run.py:_console_start():2114] atexit reg
2023-12-01 15:54:21,746 INFO    MainThread:81570 [wandb_run.py:_redirect():1969] redirect: SettingsConsole.WRAP_RAW
2023-12-01 15:54:21,746 INFO    MainThread:81570 [wandb_run.py:_redirect():2034] Wrapping output streams.
2023-12-01 15:54:21,746 INFO    MainThread:81570 [wandb_run.py:_redirect():2059] Redirects installed.
2023-12-01 15:54:21,747 INFO    MainThread:81570 [wandb_init.py:init():831] run started, returning control to user process
2023-12-01 15:54:45,955 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Configure stats pid to 81570
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/.config/wandb/settings
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Loading settings from /home/sxr280/BERTLocRNA/scripts/wandb/settings
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'root_dir': '/home/sxr280/wandb_logs'}
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/train_model.py', 'program': 'train_model.py'}
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_init.py:_log_setup():506] Logging user logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/parnet/wandb/run-20231201_155445-v6ar67es/logs/debug.log
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_init.py:_log_setup():507] Logging internal logs to /home/sxr280/BERTLocRNA/scripts/../output/RNAlocalization/parnet/wandb/run-20231201_155445-v6ar67es/logs/debug-internal.log
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_init.py:init():546] calling init triggers
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_init.py:init():552] wandb.init called with sweep_config: {}
config: {'_metadata': ContainerMetadata(ref_type=typing.Any, object_type=<class 'dict'>, optional=True, key=None, flags={'struct': True}, flags_root=False, resolver_cache=defaultdict(<class 'dict'>, {'now': {('%Y-%m-%d',): '2023-12-01', ('%H-%M-%S',): '15-54-12'}}), key_type=typing.Any, element_type=typing.Any), '_parent': None, '_flags_cache': {'struct': True, 'convert': None}, '_content': {'model': 'base_model', 'task': 'RNAlocalization', 'embedder': 'parnet', 'batch_size': 8, 'compartments': ['Nucleus', 'Exosome', 'Cytosol', 'Cytoplasm', 'Ribosome', 'Membrane', 'Endoplasmic reticulum', 'Microvesicle', 'Mitochondrion'], 'output_dir': '${hydra:runtime.cwd}/../output/${task}/${embedder}', 'RNAlocalization': {'path': 'TerminatorJ/localization_multiRNA'}, 'wandb': {'project': 'BERTLocRNA', 'name': 'benchmark_embedding'}, 'base_model': {'_target_': 'BERTLocRNA.models.base_model.CustomizedModel', 'config': {'nb_classes': 9, 'dim_attention': 80, 'headnum': 3, 'drop_flat': 0.25, 'Att_regularizer_weight': 0.001, 'fc_dim': 100, 'normalizeatt': True, 'attmod': 'smooth', 'sharp_beta': 1, 'activation': 'gelu', 'activation_att': 'tanh', 'attention': True, 'RNA_dim': 4, 'RNA_order': ['UNK', 'A', 'C', 'G', 'T', 'N', 'Y RNA', 'lincRNA', 'lncRNA', 'mRNA', 'miRNA', 'ncRNA', 'pseudo', 'rRNA', 'scRNA', 'scaRNA', 'snRNA', 'snoRNA', 'vRNA']}}, 'parnet': {'_target_': 'BERTLocRNA.utils.embedding_generator.ParnetEmbedder', 'model_path': '/home/sxr280/BERTLocRNA/RBPLLM/Parnet', 'batch_size': '${batch_size}', 'dataloader': True}, 'nucleotidetransformer': {'_target_': 'BERTLocRNA.utils.embedding_generator.NucleotideTransformerEmbedder', 'model_path': 'InstaDeepAI/nucleotide-transformer-2.5b-multi-species', 'batch_size': '${batch_size}', 'dataloader': True}, 'Trainer': {'config': {'class_weights': 'None', 'accelerator': 'gpu', 'strategy': 'ddp', 'max_epochs': 500, 'precison': 32, 'num_nodes': 1, 'log_every_n_steps': 1000, 'patience': 20, 'output_dir': '${output_dir}', 'RNA_order': '${base_model.config.RNA_order}'}}}}
2023-12-01 15:54:45,956 INFO    MainThread:81570 [wandb_init.py:init():597] wandb.init() called when a run is still active
2023-12-01 15:54:55,571 WARNING MsgRouterThr:81570 [router.py:message_loop():77] message_loop has been closed
